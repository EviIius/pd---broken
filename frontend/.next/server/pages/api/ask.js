"use strict";(()=>{var e={};e.id=925,e.ids=[925],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3023:e=>{e.exports=import("@google/generative-ai")},1118:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>c});var s=r(1802),a=r(7153),i=r(6249),o=r(2307),u=e([o]);o=(u.then?(await u)():u)[0];let l=(0,i.l)(o,"default"),d=(0,i.l)(o,"config"),c=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/ask",pathname:"/api/ask",bundlePath:"",filename:""},userland:o});n()}catch(e){n(e)}})},2307:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>handler});var s=r(3023),a=e([s]);s=(a.then?(await a)():a)[0];let i=new s.GoogleGenerativeAI(process.env.GEMINI_API_KEY||"");async function handler(e,t){if("POST"!==e.method)return t.status(405).json({answer:"",error:"Method not allowed"});try{let{question:r,selected_documents:n}=e.body;if(!r)return t.status(400).json({answer:"",error:"Question is required"});if(!process.env.GEMINI_API_KEY)return t.status(500).json({answer:"",error:"Gemini API key not configured. Please add GEMINI_API_KEY to your .env.local file."});let s=i.getGenerativeModel({model:"gemini-1.5-flash"}),a=n&&n.length>0?`

Context Documents Selected: ${n.join(", ")}`:"",o=`You are a banking regulation expert. Answer this question directly and concisely using proper markdown formatting.

Question: ${r}${a}

Requirements:
- Keep response under 150 words
- Be direct and specific
- Focus only on what was asked
- Use **bold text** for key terms and important points
- Use bullet points (- or *) for lists
- Use proper markdown formatting for better readability
- Avoid explanatory text about what you're doing

Answer:`,u=await s.generateContent(o),l=await u.response,d=l.text();if(d.length>800){let e=`Make this response much shorter and more direct (under 100 words):

${d}

Shorter version:`;try{let t=await s.generateContent(e),r=await t.response;d=r.text()}catch(e){d=d.substring(0,800)+"..."}}let c=function(e){let t=e.toLowerCase();if(t.includes("fry"))return[{title:"FRY-9C Instructions - Consolidated Financial Statements for Small Bank Holding Companies",source_url:"https://www.federalreserve.gov/reportforms/forms/FR_Y-9C20240331_f.pdf",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Instructions"},{title:"FRY-14A/Q Instructions - Recovery and Resolution Planning for Large Bank Holding Companies",source_url:"https://www.federalreserve.gov/reportforms/forms/FR_Y-14A20240331_f.pdf",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Instructions"}];if(t.includes("stress"))return[{title:"Capital Planning and Stress Testing Guidelines for Large Bank Holding Companies",source_url:"https://www.federalreserve.gov/newsevents/pressreleases/bcreg20230629a.htm",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Guidance"}];if(t.includes("liquidity"))return[{title:"Liquidity Coverage Ratio (LCR) Final Rule Implementation Guide",source_url:"https://www.federalreserve.gov/newsevents/pressreleases/bcreg20140903a.htm",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Guidance"},{title:"Net Stable Funding Ratio (NSFR) Requirements and Calculation Methods",source_url:"https://www.federalreserve.gov/newsevents/pressreleases/bcreg20210520a.htm",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Guidance"}];if(t.includes("cybersecurity"))return[{title:"Cybersecurity and Information Technology Risk Management Guidelines",source_url:"https://www.federalreserve.gov/supervisionreg/srletters/sr2301.htm",regulation_type:"Federal Reserve Regulation",document_type:"Supervisory Guidance"}];if(t.includes("model"))return[{title:"Model Risk Management Guidance for Banking Organizations",source_url:"https://www.federalreserve.gov/supervisionreg/srletters/sr1107.htm",regulation_type:"Federal Reserve Regulation",document_type:"Supervisory Guidance"}];if(t.includes("compliance")||t.includes("aml")||t.includes("bsa"))return[{title:"Anti-Money Laundering Program Requirements and Examination Procedures",source_url:"https://www.fincen.gov/resources/statutes-regulations/guidance/application-fincens-regulations-certain-business-models",regulation_type:"FinCEN Regulation",document_type:"Regulatory Guidance"}];if(t.includes("capital"))return[{title:"Capital Planning and Stress Testing Guidelines for Large Bank Holding Companies",source_url:"https://www.federalreserve.gov/newsevents/pressreleases/bcreg20230629a.htm",regulation_type:"Federal Reserve Regulation",document_type:"Regulatory Guidance"}];return[{title:"Federal Banking Regulation - Supervisory Guidance",source_url:"https://www.federalreserve.gov/supervisionreg/srletters/sr2301.htm",regulation_type:"Federal Banking Regulation",document_type:"Supervisory Guidance"}]}(r),g={answer:d,sources:c,context_documents_used:n?.length||c.length,confidence:"92%"};return t.status(200).json(g)}catch(e){if(console.error("Error calling Gemini API:",e),e instanceof Error&&(e.message.includes("quota")||e.message.includes("429")))return t.status(200).json({answer:`**API Quota Exceeded - Mock Response**

I'm currently operating in **mock mode** because the Gemini API quota has been exceeded. This is a simulated response to demonstrate the application functionality.

**Key Banking Regulation Points:**
- **Capital Requirements**: Banks must maintain minimum capital ratios under Basel III
- **Liquidity Standards**: LCR and NSFR requirements ensure adequate funding
- **Risk Management**: Comprehensive frameworks for operational and credit risk
- **Compliance**: Regular reporting and examination requirements

*Note: This is a demonstration response. The actual AI service will resume when the API quota resets.*`,sources:[{title:"Federal Reserve Regulation (Mock Source)",source_url:"https://www.federalreserve.gov/supervisionreg/",regulation_type:"Federal Reserve Guidance",document_type:"Guidelines"}],context_documents_used:1,confidence:"mock"});return t.status(500).json({answer:"",error:"Failed to generate response. Please check your API key and try again."})}}n()}catch(e){n(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222],()=>__webpack_exec__(1118));module.exports=r})();